---
layout: post
title: "TIL: 간헐적인 터미널 화면의 일시정지"
description: "오늘의 삽질 일기: nfs 데몬이 정상적이지 않을 때 일어납니다. nfs 데몬을 재시작해 줌으로써 해결하였습니다."
tags: [TIL, terminal, freeze, putty, nfs]
comments: true
share: true
---

아예 동작을 하지 않거나 오류를 뿌려주면 손 쉽게 해결되는데, 그렇지 않은 것들은 문제의 원인부터 찾기가 쉽지 않을 때가 많다. 현재 사용하는 리눅스 서버(CentOS)를 재부팅 후 터미널(PuTTY) 환경에서 간헐적으로 커서가 일시정지 하는 현상이 발견되었다. Prompt에서 명령어를 입력하는 도중 혹은 명령어를 입력한 후 출력되고 있는 와중에 몇 초간 화면이 일시정지 된다. 제일 큰 불편은 vi 편집 도중 커서가 멈춰버려서 자주 오타가 났던 점이다.

혹시 터미널 문제인가 싶어 다른 SSH Client를 설치하여 보기도 하고, 서버의 메모리 및 CPU 자원을 수 차례 감시해보기도 하였다. 문제는 동일하게 계속되었다. 그렇게 몇 일을 불편하게 지내다가 한 명령어를 실행해보고 나서 문제의 원인을 찾게 되었다. 바로 `df` 명령어(현재 마운트 되어 있는 디스크 및 폴더 알려주는 명령어)였다. `df` 명령어를 치니 현재 마운트가 제대로 되어 있지 않은 디스크의 바로 전 라인까지만 출력이 되고 계속 멈춰있는 것이었다. `Ctrl`+`c`를 눌러 멈춰있는 상황을 빠져나왔다.

현재 서버에는 대용량 데이터 저장 목적으로 여러 대의 직접 연결 저장장치(DAS)가 물려있다. 심지어 마운트에 문제가 있었던 저장장치의 파일에는 액세스가 가능하면서도 간헐적으로 끊기는 현상이 지속되었던 것이다. 정상적으로 돌아가는 상황도 아니고 아예 오류가 발생한 상황도 아닌 애매한 상황이었다.

해결은 DAS가 물려 있는 서버의 root 계정으로 가서 네트워크 파일 시스템 데몬(NFS)을 재시작 `service nfs restart` 해주는 것이었다. nfs 데몬이 재시작 되고 나니 계속 되던 현상이 사라졌다.